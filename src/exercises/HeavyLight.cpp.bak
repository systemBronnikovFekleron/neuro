#include "HeavyLight.h"

namespace Bronnikov {

HeavyLight::HeavyLight()
    : Exercise("Тяжелое и Легкое",
               "Развитие контроля над восприятием веса и плотности энергии. "
               "Практикующий создает контрастные ощущения тяжести и легкости в теле.")
{
    initializeInstructions();
    initializeTargetMetrics();
}

void HeavyLight::initializeInstructions() {
    // Preparation Phase
    addInstruction("Лягте на спину, руки вдоль тела", ExercisePhase::Preparation, 15);
    addInstruction("Закройте глаза и расслабьтесь", ExercisePhase::Preparation, 15);
    addInstruction("Сделайте несколько глубоких вдохов", ExercisePhase::Preparation, 20);
    addInstruction("Почувствуйте естественный вес своего тела", ExercisePhase::Preparation, 15);

    // Execution Phase - Тяжесть
    addInstruction("Сосредоточьтесь на правой руке", ExercisePhase::Execution, 20);
    addInstruction("Представьте, что рука становится очень тяжелой", ExercisePhase::Execution, 30);
    addInstruction("Рука наливается свинцовой тяжестью, тонет в поверхности", ExercisePhase::Execution, 30);
    addInstruction("Почувствуйте, что не можете поднять эту руку", ExercisePhase::Execution, 25);

    // Execution Phase - Легкость
    addInstruction("Теперь сосредоточьтесь на левой руке", ExercisePhase::Execution, 20);
    addInstruction("Представьте, что рука становится очень легкой", ExercisePhase::Execution, 30);
    addInstruction("Рука наполняется воздухом, как воздушный шар", ExercisePhase::Execution, 30);
    addInstruction("Почувствуйте, как рука сама поднимается вверх", ExercisePhase::Execution, 25);

    // Execution Phase - Смена полярности
    addInstruction("Поменяйте ощущения: правая рука легкая, левая тяжелая", ExercisePhase::Execution, 35);
    addInstruction("Еще раз поменяйте полярность", ExercisePhase::Execution, 30);
    addInstruction("Сделайте обе руки тяжелыми одновременно", ExercisePhase::Execution, 25);
    addInstruction("Сделайте обе руки легкими одновременно", ExercisePhase::Execution, 25);
    addInstruction("Распространите ощущения на все тело", ExercisePhase::Execution, 30);

    // Completion Phase
    addInstruction("Верните рукам естественный вес", ExercisePhase::Completion, 20);
    addInstruction("Пошевелите пальцами рук и ног", ExercisePhase::Completion, 10);
    addInstruction("Потянитесь всем телом", ExercisePhase::Completion, 10);
    addInstruction("Медленно откройте глаза", ExercisePhase::Completion, 10);
}

void HeavyLight::initializeTargetMetrics() {
    // Целевое состояние: гибкость управления состояниями
    // Упражнение требует переключения между разными режимами работы мозга

    m_target_metrics.alpha_change = 15.0;           // +15% (контроль состояний)
    m_target_metrics.beta_change = 12.0;            // +12% (управление вниманием)
    m_target_metrics.theta_change = 8.0;            // +8% (погружение в ощущения)

    m_target_metrics.concentration_change = 20.0;   // +20% (контроль переключений)
    m_target_metrics.relaxation_change = 18.0;      // +18% (расслабление для контроля)

    // Веса для scoring - баланс показателей
    m_target_metrics.alpha_weight = 1.0;
    m_target_metrics.beta_weight = 1.0;             // Равный баланс
    m_target_metrics.theta_weight = 0.7;
    m_target_metrics.concentration_weight = 1.1;    // Концентрация важна
    m_target_metrics.relaxation_weight = 1.0;
}

} // namespace Bronnikov
